"""Comprehensive test for PinHeader component."""

load("../../generics/PinHeader.zen", "Mount", "Pitch", "Orientation", "Gender")
load("../match_generics.zen", "assign_house_parts")

PinHeader = Module("../../generics/PinHeader.zen")

PH_SINGLE_ROW_PINS = [4, 6, 10, 14, 16, 24, 32]
PH_DUAL_ROW_PINS = [2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 16, 17, 18]
PH_HOUSE_PARTS = [
    (pitch, rows, pins, orientation, gender, mount)
    for pitch in ["2.54mm"]
    for rows in [1, 2]
    for pins in {1: PH_SINGLE_ROW_PINS, 2: PH_DUAL_ROW_PINS}[rows]
    for orientation in ["Vertical"]
    for gender in ["Male"]
    for mount in ["SMD"]
]

for id, (pitch, rows, pins, orientation, gender, mount) in enumerate(PH_HOUSE_PARTS):
    pitch_str = pitch.replace(".", "_")
    gender_str = gender
    orientation_str = orientation
    mount_str = mount
    nets = {f"P{n}": Net(f"PH{id}_{n}") for n in range(1, pins * rows + 1)}
    PinHeader(
        name=f"PH_{id}",
        mount=mount,
        pins=pins,
        rows=rows,
        orientation=orientation,
        pitch=pitch,
        gender=gender,
        **nets,
    )

builtin.add_component_modifier(assign_house_parts)
