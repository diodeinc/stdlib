"""Comprehensive test for TVS Diode component."""

load("../../interfaces.zen", "Power", "Ground")
load("../../units.zen", "PowerRange", "Voltage", "VoltageRange")
load("../../bom/match_generics.zen", "assign_house_parts")

Tvs = Module("../Tvs.zen")

vcc = Power("VCC", voltage=VoltageRange("3.3V"))
gnd = Ground("GND")

# Test all Package values
for package in Tvs.Package.values():
    name = "D_TVS_" + str(package)
    # suppress: bom.match_generic
    Tvs(
        name=name,
        package=package,
        peak_pulse_power=PowerRange("800 to 1200W"),
        reverse_clamping_voltage=VoltageRange("9 to 12V"),
        A=gnd,
        K=vcc,
    )

# Test with different voltage ratings
# suppress: bom.match_generic
Tvs(
    name="D_TVS_3V3",
    package="DO-219AB",
    peak_pulse_power=PowerRange("400 to 600W"),
    reverse_standoff_voltage=VoltageRange("3.3V"),
    reverse_clamping_voltage=VoltageRange("6 to 8V"),
    A=gnd,
    K=vcc,
)

# suppress: bom.match_generic
Tvs(
    name="D_TVS_12V",
    package="DO-214AC",
    peak_pulse_power=PowerRange("1200 to 1500W"),
    reverse_standoff_voltage=VoltageRange("12V"),
    reverse_clamping_voltage=VoltageRange("19 to 21V"),
    A=gnd,
    K=vcc,
)

# Test Bidirectional
# suppress: bom.match_generic
Tvs(
    name="D_TVS_Bi",
    package="DO-214AB",
    direction="Bidirectional",
    A=gnd,
    K=vcc,
)

# Test Optional Parameters (Minimal)
# Should work without reverse_clamping_voltage or peak_pulse_power
Tvs(name="D_TVS_Minimal", A=gnd, K=vcc)

# Test Bidirectional with generic Nets
sig_p = Net("SIG_P")
sig_n = Net("SIG_N")
# suppress: bom.match_generic
Tvs(
    name="D_TVS_Bi_Generic",
    direction="Bidirectional",
    A=sig_p,
    K=sig_n,
)

builtin.add_component_modifier(assign_house_parts)
