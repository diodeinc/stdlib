load("../../properties.zen", "Layout")

MolexPicoBlade = Module("../MolexPicoBlade.zen")


def _pin_count(variant) -> int:
    # Extract pin count from variant string, e.g. "1x14" or "1x15"
    s = str(variant)
    idx = s.find("1x")
    if idx != -1:
        start = idx + 2
        end = start
        for i in range(start, len(s)):
            if not s[i].isdigit():
                break
            end = i + 1
        return int(s[start:end])


for variant in MolexPicoBlade.MolexPicoBladeVariant:
    name = "MolexPicoBlade_" + variant.value
    pins = {"Pin_{}".format(i): Net(f"{variant}_Pin_{i}") for i in range(1, _pin_count(variant) + 1)}
    MolexPicoBlade(name=name, variant=variant.value, **pins)
